var gdjs;(function(u){function S(a){return a.setScaleX&&a.setScaleY&&a.getScaleX&&a.getScaleY}function v(a){return a.setOpacity&&a.getOpacity}function y(a){return a.setColor&&a.getColor}function C(a){return a.setCharacterSize&&a.getCharacterSize}function T(a,e,t){a/=255,e/=255,t/=255;let n=Math.max(a,e,t),s=n-Math.min(a,e,t),r=1-Math.abs(n+n-s-1),i=s&&(n===a?(e-t)/s:n===e?2+(t-a)/s:4+(a-e)/s);return[Math.round(60*(i<0?i+6:i)),Math.round((r?s/r:0)*100),Math.round((n+n-s)/2*100)]}function O(a,e,t){a=a%=360,a<0&&(a+=360),e=e/100,t=t/100;const n=e*Math.min(t,1-t),s=(r=0,i=(r+a/30)%12)=>t-n*Math.max(Math.min(i-3,9-i,1),-1);return[Math.round(s(0)*255),Math.round(s(8)*255),Math.round(s(4)*255)]}const d=class extends u.RuntimeBehavior{constructor(e,t,n){super(e,t,n);this._tweens={};this._isActive=!0;this._runtimeScene=e}updateFromBehaviorData(e,t){return!0}onDestroy(){const e=this._runtimeScene.shiftyJsScene;if(!!e)for(const t in this._tweens)this._tweens[t].instance.stop(),e.remove(this._tweens[t].instance)}_addTween(e,t,n,s,r,i){if(!this._isActive||!!d.easings[t])return;this._tweenExists(e)&&this.removeTween(e);const o=new shifty.Tweenable;this._tweens[e]=new d.TweenInstance(o,!1,s,r),this._runtimeScene.shiftyJsScene||(this._runtimeScene.shiftyJsScene=new shifty.Scene),this._runtimeScene.shiftyJsScene.add(o),o.tween(n).then(()=>{this._tweens[e]&&(this._tweens[e].hasFinished=!0),i&&this.owner.deleteFromScene(this._runtimeScene)}).catch(c=>{})}_tweenExists(e){return!!this._tweens[e]}_tweenIsPlaying(e){return this._tweens[e]&&this._tweens[e].instance.isPlaying()}_pauseTween(e){const t=this._tweens[e];t.instance.pause();const n=this._runtimeScene.shiftyJsScene;n&&n.remove(t.instance)}_resumeTween(e){const t=this._tweens[e];t.instance.resume();const n=this._runtimeScene.shiftyJsScene;n&&n.add(t.instance)}_stopTween(e,t){this._tweens[e].instance.stop(t)}_tweenHasFinished(e){return this._tweens[e].hasFinished}addVariableTween(e,t,n,s,r,i,o){this._addTween(e,r,{from:{value:n},to:{value:s},duration:i,easing:r,render:c=>t.setNumber(c.value)},this._runtimeScene.getTimeManager().getTimeFromStart(),i,o)}addObjectPositionTween(e,t,n,s,r,i){this._addTween(e,s,{from:{x:this.owner.getX(),y:this.owner.getY()},to:{x:t,y:n},duration:r,easing:s,render:o=>{this.owner.setX(o.x),this.owner.setY(o.y)}},this._runtimeScene.getTimeManager().getTimeFromStart(),r,i)}addObjectPositionXTween(e,t,n,s,r){this._addTween(e,n,{from:{x:this.owner.getX()},to:{x:t},duration:s,easing:n,render:i=>this.owner.setX(i.x)},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectPositionYTween(e,t,n,s,r){this._addTween(e,n,{from:{y:this.owner.getY()},to:{y:t},duration:s,easing:n,render:i=>this.owner.setY(i.y)},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectAngleTween(e,t,n,s,r){this._addTween(e,n,{from:{angle:this.owner.getAngle()},to:{angle:t},duration:s,easing:n,render:i=>{this.owner.setAngle(i.angle)}},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectScaleTween(e,t,n,s,r,i,o){if(!S(this.owner))return;const c=this.owner;t<0&&(t=0),n<0&&(n=0);const h=o?l=>{const m=c.getCenterXInScene(),w=c.getCenterYInScene();c.setScaleX(l.scaleX),c.setScaleY(l.scaleY),c.setCenterPositionInScene(m,w)}:l=>{c.setScaleX(l.scaleX),c.setScaleY(l.scaleY)};this._addTween(e,s,{from:{scaleX:c.getScaleX(),scaleY:c.getScaleY()},to:{scaleX:t,scaleY:n},duration:r,easing:s,render:h},this._runtimeScene.getTimeManager().getTimeFromStart(),r,i)}addObjectScaleXTween(e,t,n,s,r,i){if(!S(this.owner))return;const o=this.owner,c=i?h=>{const l=o.getCenterXInScene();o.setScaleX(h.scaleX),o.setCenterXInScene(l)}:h=>o.setScaleX(h.scaleX);this._addTween(e,n,{from:{scaleX:o.getScaleX()},to:{scaleX:t},duration:s,easing:n,render:c},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectScaleYTween(e,t,n,s,r,i){if(!S(this.owner))return;const o=this.owner,c=i?h=>{const l=o.getCenterYInScene();o.setScaleY(h.scaleY),o.setCenterYInScene(l)}:h=>o.setScaleY(h.scaleY);this._addTween(e,n,{from:{scaleY:o.getScaleY()},to:{scaleY:t},duration:s,easing:n,render:c},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectOpacityTween(e,t,n,s,r){if(!v(this.owner))return;const i=this.owner;this._addTween(e,n,{from:{opacity:i.getOpacity()},to:{opacity:t},duration:s,easing:n,render:o=>{i.setOpacity(o.opacity)}},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectColorTween(e,t,n,s,r,i){if(!y(this.owner)||!t.match("^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]);){2}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"))return;const o=this.owner,c=this.owner.getColor().split(";"),h=t.split(";");if(h.length!==3)return;let l;if(i){const m=T(parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2])),w=T(parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2]));l={from:{hue:m[0],saturation:m[1],lightness:m[2]},to:{hue:w[0],saturation:w[1],lightness:w[2]},duration:s,easing:n,render:f=>{const b=O(f.hue,f.saturation,f.lightness);o.setColor(Math.floor(b[0])+";"+Math.floor(b[1])+";"+Math.floor(b[2]))}}}else l={from:{red:c[0],green:c[1],blue:c[2]},to:{red:h[0],green:h[1],blue:h[2]},duration:s,easing:n,render:m=>{o.setColor(Math.floor(m.red)+";"+Math.floor(m.green)+";"+Math.floor(m.blue))}};this._addTween(e,n,l,this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectColorHSLTween(e,t,n,s,r,i,o,c){if(!y(this.owner))return;const h=this.owner,l=h.getColor().split(";");if(l.length<3)return;const m=T(parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])),w=n?t:m[0],f=s===-1?m[1]:Math.min(Math.max(s,0),100),b=r===-1?m[2]:Math.min(Math.max(r,0),100);this._addTween(e,i,{from:{hue:m[0],saturation:m[1],lightness:m[2]},to:{hue:w,saturation:f,lightness:b},duration:o,easing:i,render:_=>{const p=O(_.hue,_.saturation,_.lightness);h.setColor(Math.floor(p[0])+";"+Math.floor(p[1])+";"+Math.floor(p[2]))}},this._runtimeScene.getTimeManager().getTimeFromStart(),o,c)}addTextObjectCharacterSizeTween(e,t,n,s,r){if(!C(this.owner))return;const i=this.owner;this._addTween(e,n,{from:{size:i.getCharacterSize()},to:{size:t},duration:s,easing:n,render:function(c){i.setCharacterSize(c.size)}},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectWidthTween(e,t,n,s,r){this._addTween(e,n,{from:{width:this.owner.getWidth()},to:{width:t},duration:s,easing:n,render:i=>{this.owner.setWidth(i.width)}},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectHeightTween(e,t,n,s,r){this._addTween(e,n,{from:{height:this.owner.getHeight()},to:{height:t},duration:s,easing:n,render:i=>{this.owner.setHeight(i.height)}},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}isPlaying(e){return this._tweenExists(e)&&this._tweenIsPlaying(e)}exists(e){return this._tweenExists(e)}hasFinished(e){return this._tweenExists(e)&&this._tweenHasFinished(e)}pauseTween(e){this._isActive&&this._tweenExists(e)&&this._tweenIsPlaying(e)&&this._pauseTween(e)}stopTween(e,t){this._isActive&&this._tweenExists(e)&&this._tweenIsPlaying(e)&&this._stopTween(e,t)}resumeTween(e){this._isActive&&this._tweenExists(e)&&!this._tweenIsPlaying(e)&&this._resumeTween(e)}removeTween(e){!this._tweenExists(e)||(this._tweens[e].instance.stop(),this._runtimeScene.shiftyJsScene&&this._runtimeScene.shiftyJsScene.remove(this._tweens[e].instance),delete this._tweens[e])}getProgress(e){const t=this._tweens[e];if(t){const n=this._runtimeScene.getTimeManager().getTimeFromStart();return n>=t.startTime+t.totalDuration?1:(n-t.startTime)/t.totalDuration}else return 0}onDeActivate(){if(!!this._isActive){for(const e in this._tweens)if(this._tweens.hasOwnProperty(e)){const t=this._tweens[e];t.instance.isPlaying()&&(t.resumeOnActivate=!0,this._pauseTween(e))}this._isActive=!1}}onActivate(){if(!this._isActive){for(const e in this._tweens)if(this._tweens.hasOwnProperty(e)){const t=this._tweens[e];t.resumeOnActivate&&(t.resumeOnActivate=!1,this._resumeTween(e))}this._isActive=!0}}};let g=d;g.easings=["linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeOutBounce","easeInBack","easeOutBack","easeInOutBack","elastic","swingFromTo","swingFrom","swingTo","bounce","bouncePast","easeFromTo","easeFrom","easeTo"],g._currentTweenTime=0,u.TweenRuntimeBehavior=g,u.registerBehavior("Tween::TweenBehavior",u.TweenRuntimeBehavior),function(e){class a{constructor(n,s,r,i){this.resumeOnActivate=!1;this.instance=n,this.hasFinished=s,this.startTime=r,this.totalDuration=i}}e.TweenInstance=a}(g=u.TweenRuntimeBehavior||(u.TweenRuntimeBehavior={})),u.registerRuntimeSceneUnloadedCallback(function(a){const e=a.shiftyJsScene;!e||(e.stop(!1),e.empty())}),u.registerRuntimeScenePausedCallback(function(a){const e=a.shiftyJsScene;e&&e.pause()}),u.registerRuntimeSceneResumedCallback(function(a){const e=a.shiftyJsScene;!e||(g._currentTweenTime=a.getTimeManager().getTimeFromStart(),e.resume())}),u.registerRuntimeScenePreEventsCallback(function(a){g._currentTweenTime=a.getTimeManager().getTimeFromStart(),shifty.processTweens()}),shifty.Tweenable.setScheduleFunction(function(){}),shifty.Tweenable.now=function(){return g._currentTweenTime}})(gdjs||(gdjs={}));
//# sourceMappingURL=tweenruntimebehavior.js.map
